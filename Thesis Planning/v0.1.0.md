Title: Temporal Representation and Storage Valuation in Energy System Models: A Comparative Analysis of OSeMOSYS and PyPSA

How does the choice between chronological snapshots (PyPSA) and representative timeslices (OSeMOSYS) propagate through model formulations to affect storage investment recommendations in offshore wind systems?

Three contributions:
1. **Methodological**: Develop a systematic framework for distinguishing _implementation differences_ (harmonizable through parameter mapping) from _structural disagreements_ (fundamentally different but defensible problem formulations) in capacity expansion model comparison.
2. **Empirical**: Quantifies the magnitude and conditions under which temporal discretization choices affect storage capacity recommendations, using offshore wind as a test case where storage value is highly sensitive to temporal correlation patterns.
3. **Practical**: Provides an open-source Python package (`pyoscomp`) that enables reproducible model comparison studies, with documented translation protocols and validation metrics.

Why this matters:
Capacity expansion models inform multi-billion dollar infrastructure decisions. When two defensible models give different recommendations for the same system, policymakers face genuine uncertainty about which insight to trust. Yet most studies explore _parameter_ uncertainty (fuel prices, technology costs) while treating _model structure_ as given.

**The gap**: We lack systematic methods for attributing output divergence to specific formulation choices when comparing structurally different models.

**My contribution**: Demonstrate that temporal representation—a fundamental architectural choice—creates predictable patterns of divergence in storage economics, with implications for how we interpret model-based policy advice.

Within scope:
- Mathematical analysis of how OSeMOSYS's timeslice aggregation vs PyPSA's chronological dispatch affects storage state-of-charge dynamics
- Systematic scenario progression from stylized to realistic to isolate divergence sources
- Quantification of divergence in: curtailment estimates, storage sizing, arbitrage value capture, total system cost
- Attribution of divergence to temporal representation vs other formulation choices

Out of scope:
- Determining which model is "right" (both are defensible)
- Full network physics comparison (acknowledge PyPSA's network capabilities but use copper-plate mode)
- Unit commitment comparison (computational scope)
- Claiming your translation layer is lossless (document what's lost)

Methodology: The Divergence Attribution Framework
Construct a **controlled experimental progression** with three key methodological principles:

**1. Harmonization Protocol** Before any comparison, harmonize all implementation differences:
- Same discount rate, technology costs, lifetimes
- Same demand profile (annual total and shape/profile)
- Same wind capacity factor (annual total, annual average and distribution)
- PyPSA run in copper-plate mode (single node) to match OSeMOSYS single-region
- Consistent cost accounting (NPV basis with explicit salvage value)

**2. Isolation Strategy** Each scenario adds ONE complexity layer to isolate specific divergence sources:
- **Scenario 1**: Wind only → tests curtailment under temporal aggregation
- **Scenario 2**: Wind + short-duration battery (4h) → tests intra-day arbitrage value
- **Scenario 3**: Wind + long-duration storage (100h) → tests inter-seasonal shifting
- **Scenario 4**: Wind + battery + grid constraint → tests capacity credit and adequacy

**3. Multi-Metric Divergence Quantification** For each scenario, report:
- **Physical divergence**: Difference in recommended capacities (MW, MWh)
- **Operational divergence**: Curtailment rates, storage utilization, cycling frequency
- **Economic divergence**: Total system cost, LCOE, marginal value of storage
- **Attribution confidence**: Which divergence is attributable to temporal representation vs numerical solver artifacts

Validation Targets
1. Hypothesis 1: Storage sizing divergence increases with storage duration
	- Short-duration (4h battery): <10% capacity difference (models should agree)
	- Long-duration (seasonal H2): 20-40% capacity difference (structural disagreement expected)
	- **Why**: Timeslice aggregation preserves daily patterns better than seasonal patterns
2. Hypothesis 2: Curtailment estimates diverge more when wind variability is high-frequency
	- Smooth wind profiles → models agree
	- Realistic North Sea wind (hourly ramps) → OSeMOSYS underestimates curtailment by 15-30%
	- **Why**: Timeslice averaging smooths out extreme hours
3. Hypothesis 3: Economic divergence exceeds physical divergence for long-lived assets
	- 10-year horizon: cost divergence ≈ capacity divergence
	- 30-year horizon: cost divergence > 2× capacity divergence
	- **Why**: Salvage value treatment and cost accounting conventions compound over time

Case Study: North Sea Offshore Wind Hub
**System specification:**
- 1 GW offshore wind farm (realistic North Sea CF profile, ~45% annual average)
- Battery storage (power and duration as decision variables)
- 500 MW HVDC grid connection to shore
- Optional 200 MW gas peaker backup
- 2025-2050 horizon, 5-year investment periods
- Onshore demand: 4 TWh/year with realistic diurnal and seasonal variation

**Why this case:**
- Policy-relevant (EU offshore strategy, hydrogen valleys)
- Storage economics are critical (grid constraint forces local balancing)
- Temporal patterns matter (wind-demand correlation, Dunkelflaute events)
- Tractable (single-node, ~8760 snapshots in PyPSA, 4×3×8 timeslices in OSeMOSYS)

What's already out there?
1. TransitionZero is building PyPSA-OSeMOSYS interoperability (but for different purpose)
2. MODEX project did multi-model comparison (but not these two models and not offshore focus)
3. Temporal resolution studies exist (but within models, not between models that are structured differently)

| Citation                                                                              | Findings (relevant, contradictory, method-validating, future work, limitations, etc)                                                                                                                                                                                                                                                                                                                                                                                                                         |
| ------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [[van Ouwerkerk et al., 2022]]                                                        | - compare 6 German models (REMix, ELMOD, EMMA, POMMES, dynaMOD, Dieter) on standardized scenarios<br>- storage sizing diverges by 2-3x between models due to: (1) fixed vs flexible energy-to-power ratio, (2) initial/final storage level constraints, (3) pre-ordered dispatch vs LP optimization<br>-                                                                                                                                                                                                     |
| [[Gils et al., 2022]]                                                                 | - MODEX extension to sector-coupled models<br>- sector coupling introduces additional divergence sources (hydrogen pathways, heat networks, transport electrification)                                                                                                                                                                                                                                                                                                                                       |
| TransitionZero                                                                        | - built unified data model to enable OSeMOSYS (long-term planning) → PyPSA (operational validation) workflow<br>- interoperability for practitioners                                                                                                                                                                                                                                                                                                                                                         |
| [[Jenkins et al., 2024]]                                                              | - value of LDES is highly sensitive to modelled temporal resolution and how representative operational periods are linked<br>- period-linking is critical; without it, seasonal storage is undervalued<br>- inaccurate representation of LDES can lead to unrealistically high cost of emissions reductions                                                                                                                                                                                                  |
| [[Frew et al., 2023]]                                                                 | - systems with wind, solar, storage more sensitive to changes in representative days<br>- considering 5-minute dispatch resolution results in portfolios with less solar capacity and more energy storage capacity than hourly intervals<br>- sub-hourly volatility in solar overlooked by hourly models                                                                                                                                                                                                     |
| [[Kotzur et al., 2022]]                                                               | - system cost well-represented with 10 representative days<br>- capacity mix needs 50+ days <br>- regional capacities from models with reduced temporal resolution should not be trusted to be correct<br>- error higher for 5-day VS 1-day periods (storage formulation matters)                                                                                                                                                                                                                            |
| How Modeling Choices Shape Energy Storage Results Part 1: Representing Time and Space | [Energy Central](https://www.energycentral.com/energy-management/post/how-modeling-choices-shape-energy-storage-results-part-1-representing-zRvgLU4PWQkHAie)<br><br>- higher temporal resolution tends to select more new, longer-duration storage capacity<br>- lower temporal resolution tends to select greater amounts of shorter-duration storage<br>- temporal aggregation smooths price spreads --> undermines long-duration storage value                                                            |
| [[Xu et al., 2024]]                                                                   | - investments suggested by cases with low spatial resolution are more costly to operate<br>- increase in fuel costs indicates operations models must mobilize expensive resources to meet local demand<br>- spatial resolution impact > temporal resolution impact (for their case)<br>- accuracy of resource siting strongly impacted by capacity expansion phase model resolution<br>- copper-plate (single-node) to isolate temporal effects; spatial effects confound temporal effects if not controlled |
| [[Poncelet et al., 2022]]                                                             | - multi-criteria clustering yields lowest RMSE across all datasets<br>- holistic view of intertwined relationships between renewable generation and electricity demand                                                                                                                                                                                                                                                                                                                                       |
| Energy Storage Capacity Planning Method for Improving Offshore Wind Power Consumption | [MDPI](https://www.mdpi.com/2071-1050/14/21/14589) - Chinese coastal grid                                                                                                                                                                                                                                                                                                                                                                                                                                    |

Common theme: All recognize grid constraint + storage need for offshore wind. None compare model formulations and attribute divergence to differing temporal representation philosophies. They assume a modeling approach. We compare modeling approaches to quantify model structural uncertainty in their conclusions.

Community Interest:

A. TransitionZero Announcement (June 2024)
- Blog post on PyPSA-OSeMOSYS interoperability received positive community reception [Transitionzero](https://www.transitionzero.org/technology/open-source-interoperability-integrating-osemosys-and-pypsa-for-power-system-analysis)
- Indicates community recognizes need for model integration/comparison
B. PyPSA GitHub Issues
- Issue #14 (`EnergyModels.jl`): Discussion on representing investment periods with different snapshot resolutions per period [GitHub](https://github.com/PyPSA/EnergyModels.jl/issues/14) - shows temporal representation is active development area
- Issue #36 (Multi-Horizon Investment): Request for multi-period optimization with varying temporal resolution per period [GitHub](https://github.com/PyPSA/PyPSA/issues/36) - indicates flexibility in temporal structure is desired
C. OSeMOSYS Community Activity
- Pull Request #29: Alternate storage code that "runs faster but does not account for intra-time-slice variations... appropriate for some types of storage... but not others" [GitHub](https://github.com/OSeMOSYS/OSeMOSYS_GNU_MathProg/pull/29)
- Issue #125 (`osemosys_global`): Bug report showing capacity factor calculation sensitivity to timeslice design (wind CF 23.5% vs 26.5% with different resolutions) [GitHub](https://github.com/OSeMOSYS/osemosys_global/issues/125)
Interpretation: Community is aware of temporal representation challenges and actively working on them, but no systematic comparison framework exists yet.

| Theme                                                      | Existing                                                                               | Missing                                                                                              | Our Contribution                                                                            |
| ---------------------------------------------------------- | -------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------- |
| Methodological Gap: No PyPSA-OSeMOSYS Comparison Framework | MODEX (within Germany), sector-specific comparisons, similarly structured models       | Comparison of chronological (PyPSA) vs representative timeslice (OSeMOSYS) architectures             | Translation layer + attribution methodology                                                 |
| Empirical Gap: Offshore Wind + Storage Sensitivity Unknown | Studies assume offshore wind is "special" (requires storage, has correlation patterns) | Quantification of how much model choice affects offshore wind/storage recommendations                | Controlled experiments isolating temporal representation                                    |
| Practical Gap: Model Selection Guidance Lacking            | "Different models for different purposes" (vague)                                      | "Under these conditions, model choice matters X% for storage sizing"                                 | Decision framework: when is OSeMOSYS "good enough" vs when you need PyPSA's temporal detail |
| Conceptual Gap: Implementation vs Structural Divergence    | Model comparisons report differences but don't attribute them                          | Systematic distinction between harmonizable (implementation) and fundamental (structural) divergence | Framework for attribution + roadmap for what can/cannot be harmonized                       |

Limitations to pre-emptively address:
1. Copper-plate simplification (no network) - Cite Xu et al. 2024 to justify isolating temporal from spatial
2. No unit commitment (MILP complexity) - Cite MODEX studies showing UC introduces additional divergence orthogonal to your focus
3. Timeslice design not optimized - Cite Poncelet et al. 2022 on clustering methods; note OSeMOSYS uses categorical structure
4. Short planning horizon (to maintain tractability) - Cite literature on myopic vs perfect foresight

Future work:
1. Network constraints + temporal representation (spatial-temporal interaction)
2. Stochastic extensions (uncertainty + temporal representation)
3. Multi-model ensemble approach (using your framework as foundation)